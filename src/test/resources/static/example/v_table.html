<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>表格使用 </title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
</head>

<body>
<v-app>
    <v-tab ref="tab">
        <v-tab-pane label="查询条件-表格">
            <v-row>
                <v-col span="10"><v-form  ajax_url="/xmodel/get_query" ref="queryForm"></v-form></v-col>
                <v-col span="2">
                    <button class="layui-btn" @click="requery"><i class="fa fa-search"></i> 查询</button>
                </v-col>
            </v-row>

            <v-table ajax_url="/xmodel/list"  ref="table1" :operations="operations" :render="render" ></v-table>
        </v-tab-pane>
        <v-tab-pane label="添加">
            <v-form ajax_url="/test/form/get" submit_url="/test/form/add"></v-form>
        </v-tab-pane>
        <v-tab-pane label="html">
            <p>带查询表单的表格示例代码</p>
            <pre v-text="code" ></pre>
        </v-tab-pane>


    </v-tab>
    <v-tab>
        <v-tab-pane label="可编辑表格">
            <v-table ajax_url="/xmodel/list"  ref="table2" :operations="operations" :render="render" editable="true"></v-table>
        </v-tab-pane>
        <v-tab-pane label="html">
            <p>带查询表单的表格示例代码</p>
            <pre v-text="code" >

            </pre>
        </v-tab-pane>

    </v-tab>
</v-app>
<script src="/lib/lib.js"></script>
<script>

    app.main({
        
        data : function () {
            return {
                operations : [
                    {
                        name : '编辑' ,
                        method : function(row ) {
                            this.$root.$refs.tab.change_tab(1)
                        }
                    } ,
                    {
                        name : '修改'  ,
                        class:'btn-info',
                        method : function(row , row_number) {
                            this.change_row(row)
                            axios.post('/test/form/update' , row).then(function(response){
                                $.alert(response.data)
                            })
                        }
                    }
                ] ,
                render:{
                    myIcon: function(row , $table) {
                        return '<i class="' + row.myIcon + '"></i>'
                    }
                } ,
                code :
`<v-row>
    <v-col span="10"><v-form  ajax_url="/xmodel/get_query" ref="queryForm"></v-form></v-col>
    <v-col span="2">
        <button class="layui-btn" @click="requery"><i class="fa fa-search"></i> 查询</button>
    </v-col>
</v-row>
<v-table ajax_url="/xmodel/list"  ref="table1" :operations="operations" :render="render" ></v-table>
`,
                code2:
``
            }
        } ,
        methods : {
            requery : function () {
                this.$refs.table1.refresh(this.$refs.queryForm)
                this.$refs.table2.refresh(this.$refs.queryForm)
            }
        }
    })
</script>
</body>
</html>