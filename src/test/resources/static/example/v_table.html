<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>表格使用 </title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
</head>

<body>
<v-app :data="data" >

    <v-box title="查询条件">
        <v-row>
            <v-col span="10"><v-form  ajax_url="/xmodel/get_query" ref="queryForm"></v-form></v-col>
            <v-col span="2">
                <button class="layui-btn" @click="requery"><i class="fa fa-search"></i> 查询</button>
            </v-col>
        </v-row>

        <v-table ajax_url="/xmodel/list"  ref="table1" :operations="operations" :render="render" ></v-table>
    </v-box>
    <v-box title="可编辑表格">
        <v-table ajax_url="/xmodel/list"  ref="table2" :operations="operations" :render="render" editable="true"></v-table>
    </v-box>

</v-app>
<script src="/lib/lib.js"></script>
<script>

    app.main({
        
        data : function () {
            return {
                operations : [
                    {
                        name : '编辑' ,
                        method : function(row , $table ) {

                        }
                    } ,
                    {
                        name : '修改'  ,
                        class:'btn-info',
                        method : function(row ,$table , row_number) {
                            $table.change_row(row)
                            axios.post('/test/form/update' , row).then(function(response){
                                $.alert(response.data)
                            })
                        }
                    }
                ] ,
                render:{
                    myIcon: function(row , $table) {
                        return '<i class="' + row.myIcon + '"></i>'
                    }
                }
            }
        } ,
        methods : {
            requery : function () {
                this.$refs.table1.refresh(this.$refs.queryForm)
                this.$refs.table2.refresh(this.$refs.queryForm)
            }
        }
    })
</script>
</body>
</html>